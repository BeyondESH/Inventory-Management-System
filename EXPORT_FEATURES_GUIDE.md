# 智慧餐饮管理系统 - 导出功能使用指南

## 📋 概述

智慧餐饮管理系统现已支持完整的数据导出功能，可以将各模块的数据导出为Excel、CSV、PDF等多种格式，方便数据分析和报表制作。

## 🚀 快速开始

### 1. 安装依赖库

首次使用导出功能前，请先安装必要的依赖库：

```bash
# 方法1：运行安装脚本
python install_export_dependencies.py

# 方法2：手动安装
pip install openpyxl reportlab Pillow
```

### 2. 使用导出功能

在各模块界面中，点击"📊 导出"按钮即可打开导出对话框。

## 📊 支持的导出格式

| 格式 | 扩展名 | 特点 | 适用场景 |
|------|--------|------|----------|
| Excel | .xlsx | 支持样式、格式化、多工作表 | 数据分析、报表制作 |
| CSV | .csv | 通用表格格式，兼容性好 | 数据交换、导入其他系统 |
| PDF | .pdf | 文档格式，打印友好 | 正式报表、存档 |

## 🏢 各模块导出功能

### 💰 财务管理模块

**导出内容：**
- 收支记录
- 固定成本
- 财务概览
- 完整报表

**筛选选项：**
- 时间范围：今日、本周、本月、本季度、本年、全部

**导出字段：**
- 时间、类型、描述、金额、支付方式、备注

### 📦 订单管理模块

**导出内容：**
- 订单列表

**筛选选项：**
- 订单状态：全部、待接单、已接单、制作中、配送中、已完成、已取消

**导出字段：**
- 订单号、客户姓名、联系电话、配送地址、菜品、总金额、订单状态、下单时间

### 📦 库存管理模块

**导出内容：**
- 库存数据

**筛选选项：**
- 库存类型：全部、原料、容器

**导出字段：**
- 物品名称、类型、当前库存、单位、预警阈值、状态

### 👥 客户管理模块

**导出内容：**
- 客户信息

**筛选选项：**
- 客户类型：全部、个人、企业

**导出字段：**
- 客户姓名、联系电话、客户类型、地址、备注、注册时间

### 🍽️ 菜品管理模块

**导出内容：**
- 菜品数据

**筛选选项：**
- 菜品状态：全部、上架、下架

**导出字段：**
- 菜品名称、价格、分类、状态、描述、创建时间

## 🔧 使用步骤

### 1. 选择导出格式
在导出对话框中选择需要的格式：
- **Excel**：适合需要进一步数据分析的场景
- **CSV**：适合数据交换或导入其他系统
- **PDF**：适合正式报表或存档

### 2. 设置筛选条件
根据模块不同，选择相应的筛选条件：
- 时间范围（财务管理）
- 状态筛选（订单、菜品管理）
- 类型筛选（库存、客户管理）

### 3. 选择保存位置
点击"📊 开始导出"后，选择文件保存位置和文件名。

### 4. 完成导出
系统会自动生成文件并显示成功提示。

## 📁 文件命名规则

导出的文件会自动按以下格式命名：
```
{模块名称}_{筛选条件}_{时间戳}.{扩展名}
```

示例：
- `财务收支记录_本月_20250121_143052.xlsx`
- `订单数据_已完成_20250121_143052.csv`
- `库存数据_原料_20250121_143052.pdf`

## ⚠️ 注意事项

### 1. 依赖库要求
- **openpyxl**：Excel导出必需
- **reportlab**：PDF导出必需
- **Pillow**：PDF导出依赖

### 2. 文件大小限制
- Excel文件：建议不超过10万行数据
- CSV文件：无特殊限制
- PDF文件：建议不超过1000行数据

### 3. 中文编码
- 所有导出文件均使用UTF-8编码
- CSV文件使用UTF-8-BOM编码，确保Excel正确显示中文

### 4. 数据实时性
- 导出的数据为当前系统状态
- 建议在数据更新后及时导出

## 🛠️ 故障排除

### 常见问题

**Q: 导出Excel时提示"请安装openpyxl库"**
A: 运行 `pip install openpyxl` 安装依赖库

**Q: 导出PDF时提示"请安装reportlab库"**
A: 运行 `pip install reportlab` 安装依赖库

**Q: 导出的CSV文件在Excel中显示乱码**
A: 系统已使用UTF-8-BOM编码，请确保Excel版本支持

**Q: 导出大量数据时系统卡顿**
A: 建议分批导出或使用CSV格式

### 性能优化建议

1. **大数据量导出**：优先使用CSV格式
2. **正式报表**：使用PDF格式
3. **数据分析**：使用Excel格式
4. **定期导出**：避免一次性导出过多数据

## 📞 技术支持

如遇到导出功能问题，请检查：
1. 依赖库是否正确安装
2. 系统权限是否足够
3. 磁盘空间是否充足
4. 文件路径是否有效

---

*最后更新：2025年1月21日*
*版本：v1.0* 